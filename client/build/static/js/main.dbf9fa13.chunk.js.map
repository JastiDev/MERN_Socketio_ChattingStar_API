{"version":3,"sources":["modules/common.js","http/HttpUser.js","modules/Auth.js","pages/LogIn.js","components/CountrySeletor.js","components/Avatar.js","pages/SignUp.js","http/HttpStar.js","components/AuthButton.js","components/StarList.js","components/InputContainer.js","components/Star.js","components/Room.js","components/MapContainer.js","components/CountrySeletorSmall.js","components/FilterBox.js","pages/Main.js","components/PrivateRoute.js","App.js","serviceWorker.js","index.js"],"names":["socket","getSocket","io","dicUser","getDicUser","updateDicUser","arrOne","a","i","length","username","HttpUser","resp","user","data","me","arrMate","tryLogIn","password","axios","post","trySignUp","obj","checkToken","token","get","headers","getOneByName","Auth","tokenAddr","getToken","localStorage","getItem","setItem","console","log","doLogOut","removeItem","checkAuth","LogIn","useState","setUsername","setPassword","busy","setBusy","history","useHistory","isAuthed","replace","pathname","active","spinner","text","className","src","alt","preload","autoPlay","loop","muted","type","onSubmit","e","preventDefault","href","placeholder","onChange","target","value","CountrySelector","props","arrCountry","countryList","getData","style","border","display","code","this","height","id","name","map","country","key","label","Component","Avatar","upImg","setUpImg","imgRef","setImgRef","unit","width","aspect","crop","setCrop","previewUrl","setPreviewUrl","isCropping","setIsCropping","onLoad","useCallback","img","makeClientCrop","createCropPreview","image","fileName","canvas","document","createElement","scaleX","naturalWidth","scaleY","naturalHeight","getContext","drawImage","x","y","Promise","resolve","reject","toBlob","blob","window","URL","revokeObjectURL","theURL","createObjectURL","handleChange","Error","handleCloseModal","onClick","$","click","zIndex","accept","files","reader","FileReader","addEventListener","result","readAsDataURL","Modal","color","show","onHide","Header","closeButton","Title","Body","maxHeight","overflow","onImageLoaded","c","onComplete","Footer","Button","variant","SignUp","setCountry","gender","setGender","age","setAge","imgUrl","setImgUrl","onSubmitForm","event","recaptchaRef","current","getValue","useRef","url","marginLeft","sitekey","ref","theme","getMap","getXY","idSocket","AuthButton","Div","styled","div","strGender","StarList","arrStar","filter","moveToStar","handleBlock","paddingTop","star","position","top","right","IconHover","InputContainer","content","setContent","showEmoji","setShowEmoji","emojiPicker","handleSubmit","strContent","trim","padding","fontSize","onKeyUp","evt","keyCode","autoFocus","minHeight","bottom","left","onSelect","emoji","native","emojiTooltip","title","xyInRoom","xx","parseInt","ROOM_W","yy","Star","isMe","lastName","setLastName","setX","setY","timerMove","setTimerMove","isOverAvatar","setIsOverAvatar","isOverMsg","setIsOverMsg","isEdit","setIsEdit","tailX","setTailX","tailY","setTailY","isTail","setIsTail","useEffect","clearInterval","Math","abs","soonMove","lazyMove","parent","getElementById","docViewTop","scrollTop","docViewBottom","clientHeight","docViewLeft","scrollLeft","docViewRight","clientWidth","scrollTo","behavior","len","arrMsg","starSender","k","findIndex","mate","common","sender","starReceiver","sx","sy","ex","ey","lazyMoveTail","px","py","t","dt","nStep","dx","dy","cnt","setInterval","setTimeout","timerMoveTail","clickID","ROOT_CSS","css","overflowX","transform","onMouseMove","onMouseLeave","overflowY","rx","ry","fill","stroke","strokeWidth","opacity","message","receiver","receiverSocketId","emit","Room","room","handleClickSVG","handleClickStar","dim","getBoundingClientRect","clientX","clientY","delta","tmp","split","roomToDelta","MapContainer","roomBlocks","j","push","handleClick","CountrySelectorSmall","FilterBox","handleChangeFilter","Number","StrongHover","strong","Main","setArrStar","setFilter","setRoom","setMe","setArrMate","isMap","setIsMap","initArrStar","HttpStar","doSetSocketHandlers","on","slice","alert","substr","newArrMsg","shift","newMate","moveMe","confirm","elementParent","PrivateRoute","state","isLoading","check","setState","rest","render","location","children","to","React","App","path","Boolean","hostname","match","ReactDOM","navigator","serviceWorker","ready","then","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.dbf9fa13.chunk.js","sourcesContent":["import io from \"socket.io-client\";\r\nimport * as HttpUser from \"../http/HttpUser\";\r\n\r\nexport const server_url = \"\";\r\n\r\nlet socket = null;\r\nexport const getSocket = () => {\r\n  if (socket == null) socket = io(`${server_url}/star-move`);\r\n  return socket;\r\n};\r\n\r\nlet dicUser = {};\r\nexport const getDicUser = () => {\r\n  return dicUser;\r\n};\r\n\r\nexport const updateDicUser = async (arrOne) => {\r\n  for (let i = 0; i < arrOne.length; i++) {\r\n    let username = arrOne[i].username;\r\n    if (dicUser[username]) continue;\r\n    let resp = await HttpUser.getOneByName(username);\r\n    let { user } = resp.data;\r\n    dicUser[username] = user;\r\n  }\r\n};\r\n\r\nlet me = {};\r\nlet arrMate = [];\r\nexport const setMe = (_me) => {\r\n  me = _me;\r\n};\r\n\r\nexport const setArrMate = (_arrMate) => {\r\n  arrMate = _arrMate;\r\n};\r\n\r\nexport const findInRoom = (username) => {\r\n  if (me.username == username) return me;\r\n  let k = arrMate.findIndex((mate) => mate.username == username);\r\n  if (k > -1) return arrMate[k];\r\n  return null;\r\n};\r\n","import axios from \"axios\";\r\nimport * as Auth from \"../modules/Auth\";\r\nimport { server_url } from \"../modules/common\";\r\n\r\nexport const tryLogIn = (username, password) =>\r\n  axios.post(`${server_url}/api/user/login`, { username, password });\r\n\r\nexport const trySignUp = (obj) =>\r\n  axios.post(`${server_url}/api/user/signup`, { obj });\r\n\r\nexport const checkToken = (token) => {\r\n  return axios.get(`${server_url}/api/user/checkToken`, {\r\n    headers: { token: token },\r\n  });\r\n};\r\n\r\nexport const getOneByName = async (username) => {\r\n  let token = await Auth.getToken();\r\n  return axios.post(\r\n    `${server_url}/api/user/getOneByName`,\r\n    { username },\r\n    { headers: { token: token } }\r\n  );\r\n};\r\n\r\nexport const getManyByName = async (arrName) => {\r\n  let token = await Auth.getToken();\r\n  return axios.post(\r\n    `${server_url}/api/user/getManyByName`,\r\n    { arrName },\r\n    { headers: { token: token } }\r\n  );\r\n};\r\n","import * as HttpUser from \"../http/HttpUser\";\r\n\r\nconst tokenAddr = \"token_chattingstar\";\r\n\r\nexport const getToken = async () => {\r\n  let token = await localStorage.getItem(tokenAddr);\r\n  return token;\r\n};\r\n\r\nexport const tryLogIn = async (username, password) => {\r\n  try {\r\n    let resp = await HttpUser.tryLogIn(username, password);\r\n    let token = resp.data.token;\r\n    await localStorage.setItem(tokenAddr, token);\r\n    return true;\r\n  } catch (err) {\r\n    console.log(err);\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const trySignUp = async (obj) => {\r\n  try {\r\n    let resp = await HttpUser.trySignUp(obj);\r\n    let token = resp.data.token;\r\n    await localStorage.setItem(tokenAddr, token);\r\n    return true;\r\n  } catch (err) {\r\n    console.log(err);\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const doLogOut = async () => {\r\n  await localStorage.removeItem(tokenAddr);\r\n};\r\n\r\nexport const checkAuth = async () => {\r\n  try {\r\n    let token = await localStorage.getItem(tokenAddr);\r\n    if (token) {\r\n      let resp = await HttpUser.checkToken(token);\r\n      username = resp.data.username;\r\n      return true;\r\n    }\r\n  } catch (err) {\r\n    console.log(err);\r\n  }\r\n  return false;\r\n};\r\n\r\nexport let username = null;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport * as Auth from \"../modules/Auth\";\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\n\r\nexport const LogIn = () => {\r\n  const [username, setUsername] = useState();\r\n  const [password, setPassword] = useState();\r\n  const [busy, setBusy] = useState(false);\r\n\r\n  let history = useHistory();\r\n\r\n  const tryLogIn = async () => {\r\n    setBusy(true);\r\n    let isAuthed = await Auth.tryLogIn(username, password);\r\n    setBusy(false);\r\n    if (isAuthed) {\r\n      history.replace({ pathname: \"/\" });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <LoadingOverlay active={busy} spinner text=\"Loading...\">\r\n      <div className=\"logo-container\">\r\n        <img src=\"/assets/img/logo512.png\" className=\"App-logo\" alt=\"logo\" />\r\n      </div>\r\n      <video className=\"video-background\" preload=\"auto\" autoPlay loop muted>\r\n        <source src=\"/assets/video/starfield.mp4\" type=\"video/mp4\" />\r\n        Your browser does not support HTML5 video.\r\n      </video>\r\n\r\n      <div className=\"content-bottom\">\r\n        <h1>Chatting Star</h1>\r\n        <form\r\n          onSubmit={(e) => {\r\n            e.preventDefault();\r\n            tryLogIn();\r\n          }}\r\n        >\r\n          <a className=\"btn-transp-round\" href=\"/signup\">\r\n            +\r\n          </a>\r\n\r\n          <input\r\n            type=\"text\"\r\n            className=\"input-transp\"\r\n            placeholder=\"username\"\r\n            onChange={(e) => setUsername(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            className=\"input-transp\"\r\n            placeholder=\"password\"\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n\r\n          <button type=\"submit\" className=\"btn-transp\">\r\n            Log In\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </LoadingOverlay>\r\n  );\r\n};\r\n","import React, { Component } from \"react\";\r\nimport countryList from \"react-select-country-list\";\r\nimport Flag from \"react-world-flags\";\r\n\r\nexport default class CountrySelector extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.arrCountry = countryList().getData();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div style={{ border: \"1px solid yellow\", display: \"inline-block\" }}>\r\n          <Flag code={this.props.value} height=\"35px\" />\r\n        </div>\r\n        <br />\r\n        <select\r\n          id=\"country\"\r\n          name=\"country\"\r\n          className=\"input-transp w3-black\"\r\n          value={this.props.value}\r\n          onChange={(e) => this.props.onChange(e.target.value)}\r\n        >\r\n          {this.arrCountry.map((country, i) => (\r\n            <option key={i} value={country.value}>\r\n              {country.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { useState, useCallback } from \"react\";\r\nimport ReactCrop from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\n\r\nimport $ from \"jquery\";\r\nimport \"../styles/Avatar.scss\";\r\n\r\nimport { Button, Modal } from \"react-bootstrap\";\r\n\r\nexport const Avatar = (props) => {\r\n  const [upImg, setUpImg] = useState();\r\n  const [imgRef, setImgRef] = useState(null);\r\n  const [crop, setCrop] = useState({ unit: \"%\", width: 30, aspect: 9 / 9 });\r\n  const [previewUrl, setPreviewUrl] = useState();\r\n\r\n  const [isCropping, setIsCropping] = useState(false);\r\n\r\n  const onSelectFile = (e) => {\r\n    if (e.target.files && e.target.files.length > 0) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => {\r\n        setUpImg(reader.result);\r\n        setIsCropping(true);\r\n      });\r\n      reader.readAsDataURL(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  const onLoad = useCallback((img) => {\r\n    setImgRef(img);\r\n  }, []);\r\n\r\n  const makeClientCrop = async (crop) => {\r\n    if (imgRef && crop.width && crop.height) {\r\n      createCropPreview(imgRef, crop, \"newFile.jpeg\");\r\n    }\r\n  };\r\n\r\n  const createCropPreview = async (image, crop, fileName) => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const scaleX = image.naturalWidth / image.width;\r\n    const scaleY = image.naturalHeight / image.height;\r\n    canvas.width = crop.width;\r\n    canvas.height = crop.height;\r\n    const ctx = canvas.getContext(\"2d\");\r\n\r\n    ctx.drawImage(\r\n      image,\r\n      crop.x * scaleX,\r\n      crop.y * scaleY,\r\n      crop.width * scaleX,\r\n      crop.height * scaleY,\r\n      0,\r\n      0,\r\n      crop.width,\r\n      crop.height\r\n    );\r\n\r\n    return new Promise((resolve, reject) => {\r\n      canvas.toBlob((blob) => {\r\n        if (!blob) {\r\n          reject(new Error(\"Canvas is empty\"));\r\n          return;\r\n        }\r\n        blob.name = fileName;\r\n        window.URL.revokeObjectURL(previewUrl);\r\n\r\n        let theURL = window.URL.createObjectURL(blob);\r\n        setPreviewUrl(theURL);\r\n        props.handleChange(theURL);\r\n      }, \"image/jpeg\");\r\n    });\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setIsCropping(false);\r\n  };\r\n\r\n  const handleSaveModal = () => {\r\n    setIsCropping(false);\r\n    //\r\n    console.log(crop);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div\r\n        className=\"avatar-wrapper\"\r\n        onClick={(e) => $(\".file-upload\").click()}\r\n      >\r\n        <i\r\n          className=\"avatar-icon fa fa-user\"\r\n          style={{ display: upImg ? \"none\" : \"block\" }}\r\n        />\r\n        <img\r\n          src={previewUrl}\r\n          style={{ width: \"100%\", height: \"100%\", zIndex: \"10\" }}\r\n          alt=\"User\"\r\n        />\r\n        <input\r\n          className=\"file-upload\"\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={onSelectFile}\r\n        />\r\n      </div>\r\n\r\n      <Modal\r\n        style={{ color: \"black\" }}\r\n        show={isCropping}\r\n        onHide={handleCloseModal}\r\n      >\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Modal heading</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body style={{ maxHeight: \"80vh\", overflow: \"auto\" }}>\r\n          <ReactCrop\r\n            src={upImg}\r\n            onImageLoaded={onLoad}\r\n            crop={crop}\r\n            onChange={(c) => setCrop(c)}\r\n            onComplete={makeClientCrop}\r\n          />\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"secondary\" onClick={handleCloseModal}>\r\n            Close\r\n          </Button>\r\n          <Button variant=\"primary\" onClick={handleSaveModal}>\r\n            Save Changes\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useRef } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport CountrySeletor from \"../components/CountrySeletor\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\";\r\nimport { Avatar } from \"../components/Avatar\";\r\nimport * as Auth from \"../modules/Auth\";\r\n\r\nexport const SignUp = () => {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [country, setCountry] = useState(\"US\");\r\n  const [gender, setGender] = useState(0);\r\n  const [age, setAge] = useState(25);\r\n  const [imgUrl, setImgUrl] = useState(\"\");\r\n  let history = useHistory();\r\n\r\n  const onSubmitForm = async (event) => {\r\n    event.preventDefault();\r\n    const recaptchaValue = recaptchaRef.current.getValue();\r\n    // if (!recaptchaValue) return alert(\"Verify you are not a robot, please.\");\r\n    let obj = { username, password, country, gender, age, imgUrl };\r\n    let isAuthed = await Auth.trySignUp(obj);\r\n    if (isAuthed) {\r\n      history.replace({ pathname: \"/\" });\r\n    }\r\n  };\r\n\r\n  const recaptchaRef = useRef();\r\n\r\n  return (\r\n    <form className=\"container\" onSubmit={onSubmitForm}>\r\n      <div className=\"row\">\r\n        <div className=\"col\">\r\n          <Avatar handleChange={(url) => setImgUrl(url)} />\r\n\r\n          <div className=\"mt-3\">\r\n            <div>Username</div>\r\n            <input\r\n              type=\"text\"\r\n              className=\"input-transp\"\r\n              placeholder=\"username\"\r\n              onChange={(e) => setUsername(e.target.value)}\r\n            />\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <div>Password</div>\r\n            <input\r\n              type=\"password\"\r\n              className=\"input-transp\"\r\n              placeholder=\"password\"\r\n              onChange={(e) => setPassword(e.target.value)}\r\n            />\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <CountrySeletor\r\n              value={country}\r\n              onChange={(country) => setCountry(country)}\r\n            />\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <div style={{ display: \"inline-block\" }}>\r\n              <div>Age</div>\r\n              <input\r\n                type=\"number\"\r\n                className=\"input-transp-sm\"\r\n                placeholder=\"age\"\r\n                value={age}\r\n                onChange={(e) => setAge(e.target.value)}\r\n              />\r\n            </div>\r\n            <div style={{ display: \"inline-block\", marginLeft: \"10px\" }}>\r\n              <div>Gender</div>\r\n              <select\r\n                className=\"input-transp-sm w3-black\"\r\n                value={gender}\r\n                onChange={(e) => setGender(e.target.value)}\r\n              >\r\n                <option value={0}>Male</option>\r\n                <option value={1}>Female</option>\r\n                <option value={2}>Other</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <ReCAPTCHA\r\n              sitekey=\"6LcyhucUAAAAAKyGU-pG8fvZPM3ic9Iev4uSZgbi\"\r\n              ref={recaptchaRef}\r\n              theme=\"dark\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"mt-5\">\r\n            <button type=\"submit\" className=\"btn-transp\">\r\n              Sign up\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"col\">\r\n          <h1 className=\"w3-center\">HELP</h1>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n","import axios from \"axios\";\r\nimport * as Auth from \"../modules/Auth\";\r\nimport { server_url } from \"../modules/common\";\r\n\r\nexport const getMap = async () => {\r\n  let token = await Auth.getToken();\r\n  return axios.get(`${server_url}/api/star/map`, { headers: { token: token } });\r\n};\r\n\r\nexport const getXY = async (idSocket) => {\r\n  let token = await Auth.getToken();\r\n  return axios.post(\r\n    `${server_url}/api/star/getXY`,\r\n    { idSocket },\r\n    { headers: { token: token } }\r\n  );\r\n};\r\n\r\nexport const getArrMsg = async (idSocket) => {\r\n  let token = await Auth.getToken();\r\n  return axios.post(\r\n    `${server_url}/api/star/getArrMsg`,\r\n    { idSocket },\r\n    { headers: { token: token } }\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport * as Auth from \"../modules/Auth\";\r\n\r\nexport const AuthButton = () => {\r\n  let history = useHistory();\r\n\r\n  const doLogOut = async () => {\r\n    await Auth.doLogOut();\r\n    history.replace({ pathname: \"/login\" });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <strong>{Auth.username}</strong>\r\n      <button className=\"btn btn-warning ml-3\" onClick={(e) => doLogOut()}>\r\n        <i className=\"fa fa-user mr-1\" /> <i className=\"fa fa-sign-out\" />\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport * as Auth from \"../modules/Auth\";\r\nimport { getSocket, getDicUser, updateDicUser } from \"../modules/common\";\r\nimport Flag from \"react-world-flags\";\r\n\r\nimport styled from \"styled-components\";\r\nconst Div = styled.div`\r\n  border: 1px dotted grey;\r\n  &:hover {\r\n    background-color: yellow;\r\n    color: black;\r\n    cursor: pointer;\r\n  }\r\n`;\r\n\r\nconst strGender = [\"fa fa-mars\", \"fa fa-venus\", \"fa fa-genderless\"];\r\n\r\nexport const StarList = (props) => {\r\n  const { arrStar, filter, moveToStar, handleBlock } = props;\r\n\r\n  return (\r\n    <div style={{ paddingTop: \"30px\" }}>\r\n      {arrStar.map((star, i) => {\r\n        if (star.username == Auth.username) return null;\r\n        let user = getDicUser()[star.username];\r\n        if (filter.country != -1 && user.country != filter.country) return null;\r\n        if (\r\n          filter.age != -1 &&\r\n          (user.age < filter.age || user.age > filter.age + 9)\r\n        )\r\n          return null;\r\n        if (filter.gender != -1 && user.gender != filter.gender) return null;\r\n\r\n        return (\r\n          <Div\r\n            key={i}\r\n            onClick={(e) => moveToStar(star)}\r\n            style={{ position: \"relative\" }}\r\n          >\r\n            <Flag code={user.country} height=\"25px\" />\r\n            <span className=\"ml-3\">{user.username}</span>\r\n            <span style={{ position: \"absolute\", top: 0, right: 0 }}>\r\n              <span>{user.age}</span>\r\n              <span className=\"ml-2\">\r\n                {<i className={strGender[user.gender]} />}\r\n              </span>\r\n            </span>\r\n          </Div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport \"emoji-mart/css/emoji-mart.css\";\r\nimport { Picker } from \"emoji-mart\";\r\n\r\nimport styled from \"styled-components\";\r\nconst IconHover = styled.i`\r\n  &:hover {\r\n    cursor: pointer;\r\n  }\r\n`;\r\n\r\nexport const InputContainer = (props) => {\r\n  const [content, setContent] = useState(\"\");\r\n  const [showEmoji, setShowEmoji] = useState(\"\");\r\n  const emojiPicker = useRef();\r\n\r\n  const addEmoji = (e) => {\r\n    let emoji = e.native;\r\n\r\n    setContent((content) => content + emoji);\r\n  };\r\n\r\n  const toggleEmojiShow = () => {\r\n    setShowEmoji((showEmoji) => !showEmoji);\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    let strContent = content.trim();\r\n    if (strContent.length < 1) return;\r\n\r\n    props.handleSubmit(strContent);\r\n    setContent(\"\");\r\n    setShowEmoji(false);\r\n  };\r\n\r\n  return (\r\n    <foreignObject x=\"0\" y=\"200\" width=\"350\" height={showEmoji ? \"530\" : \"95\"}>\r\n      <form onSubmit={handleSubmit}>\r\n        <textarea\r\n          className=\"input-transp\"\r\n          style={{\r\n            padding: \"3px\",\r\n            fontSize: \"14px\",\r\n            width: \"100%\",\r\n          }}\r\n          placeholder=\"Type here...\"\r\n          value={content}\r\n          onKeyUp={(evt) => {\r\n            if (evt.keyCode == 13) handleSubmit(evt);\r\n          }}\r\n          onChange={(e) => {\r\n            setContent(e.target.value);\r\n          }}\r\n          autoFocus\r\n        />\r\n        <div style={{ position: \"relative\", minHeight: \"28px\" }}>\r\n          <IconHover\r\n            onClick={(e) => toggleEmojiShow()}\r\n            className=\"fa fa-smile-o h4 text-warning\"\r\n            style={{ position: \"absolute\", bottom: 0, left: 0 }}\r\n          />\r\n\r\n          <IconHover\r\n            onClick={handleSubmit}\r\n            className=\"fa fa-send-o h4 text-warning\"\r\n            style={{ position: \"absolute\", bottom: 0, right: 0 }}\r\n          />\r\n        </div>\r\n\r\n        <span\r\n          style\r\n          ref={emojiPicker}\r\n          style={{\r\n            display: showEmoji ? \"block\" : \"none\",\r\n          }}\r\n        >\r\n          <Picker\r\n            onSelect={addEmoji}\r\n            emojiTooltip={true}\r\n            title=\"ChattingStar\"\r\n          />\r\n        </span>\r\n      </form>\r\n    </foreignObject>\r\n  );\r\n};\r\n","import React, { useState, useEffect } from \"react\";\r\nimport Flag from \"react-world-flags\";\r\n\r\nimport { getSocket, getDicUser, updateDicUser } from \"../modules/common\";\r\nimport * as Auth from \"../modules/Auth\";\r\n\r\nimport * as HttpStar from \"../http/HttpStar\";\r\n\r\nimport { InputContainer } from \"./InputContainer\";\r\n\r\nimport * as common from \"../modules/common\";\r\n\r\nimport ScrollToBottom from \"react-scroll-to-bottom\";\r\nimport { css } from \"glamor\";\r\nconst xyInRoom = (x, y) => {\r\n  let xx = parseInt(x) % ROOM_W;\r\n  let yy = parseInt(y) % ROOM_W;\r\n  return { xx, yy };\r\n};\r\n\r\nconst ROOM_W = 2000; // width of room in real\r\n\r\nexport const Star = (props) => {\r\n  const { isMe, star, me } = props;\r\n\r\n  const [lastName, setLastName] = useState();\r\n  const [x, setX] = useState(star.x);\r\n  const [y, setY] = useState(star.y);\r\n  const [timerMove, setTimerMove] = useState(null);\r\n  const [isOverAvatar, setIsOverAvatar] = useState(false);\r\n  const [isOverMsg, setIsOverMsg] = useState(false);\r\n\r\n  const [isEdit, setIsEdit] = useState(false);\r\n\r\n  const [tailX, setTailX] = useState(star.x);\r\n  const [tailY, setTailY] = useState(star.y);\r\n  const [isTail, setIsTail] = useState(false);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // cleanup\r\n      if (timerMove) clearInterval(timerMove);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (lastName && lastName == star.username) {\r\n      if (timerMove) clearInterval(timerMove);\r\n      if (Math.abs(x - star.x) >= 2000 || Math.abs(y - star.y) >= 2000)\r\n        soonMove(star.x, star.y);\r\n      else lazyMove(star.x, star.y);\r\n    } else {\r\n      setLastName(star.username); //it's because of React arr Map function reuse components\r\n      setX(star.x);\r\n      setY(star.y);\r\n    }\r\n\r\n    // auto scroll to me\r\n    if (isMe) {\r\n      let parent = document.getElementById(\"star-container\");\r\n      let docViewTop = parent.scrollTop;\r\n      let docViewBottom = docViewTop + parent.clientHeight;\r\n      let docViewLeft = parent.scrollLeft;\r\n      let docViewRight = docViewLeft + parent.clientWidth;\r\n\r\n      let { xx, yy } = xyInRoom(star.x, star.y);\r\n\r\n      if (\r\n        xx <= docViewLeft ||\r\n        xx >= docViewRight ||\r\n        yy <= docViewTop ||\r\n        yy >= docViewBottom\r\n      ) {\r\n        parent.scrollTo({\r\n          left: xx - 170,\r\n          top: yy - 170,\r\n          behavior: \"smooth\",\r\n        });\r\n      }\r\n    }\r\n  }, [star.x, star.y]);\r\n\r\n  useEffect(() => {\r\n    if (lastName && lastName == star.username) {\r\n      let len = star.arrMsg.length;\r\n      if (len <= 0) return;\r\n      let msg = star.arrMsg[len - 1];\r\n\r\n      let starSender = common.findInRoom(msg.sender);\r\n\r\n      if (!starSender) return;\r\n      let starReceiver = star;\r\n\r\n      let sx = starSender.x;\r\n      let sy = starSender.y;\r\n      let ex = starReceiver.x;\r\n      let ey = starReceiver.y;\r\n\r\n      lazyMoveTail(sx, sy, ex, ey);\r\n    } else {\r\n      setLastName(star.username);\r\n    }\r\n  }, [star.arrMsg]);\r\n\r\n  const handleMsgSubmit = (content) => {\r\n    let socket = getSocket();\r\n    let receiver = star.username;\r\n    let receiverSocketId = star.idSocket;\r\n\r\n    let sender = Auth.username;\r\n    socket.emit(\"chat-msg\", { sender, receiver, receiverSocketId, content });\r\n  };\r\n\r\n  const soonMove = (px, py) => {\r\n    setX(px);\r\n    setY(py);\r\n  };\r\n\r\n  const lazyMove = (px, py, t = 1000) => {\r\n    let dt = 16;\r\n    let nStep = t / dt;\r\n    if (nStep == 0) return;\r\n    let dx = (px - x) / nStep;\r\n    let dy = (py - y) / nStep;\r\n    let cnt = 0;\r\n\r\n    let timerMove = setInterval(() => {\r\n      if (cnt < nStep) {\r\n        setX((x) => x + dx);\r\n        setY((y) => y + dy);\r\n        cnt++;\r\n      } else {\r\n        setX(px);\r\n        setY(py);\r\n        clearInterval(timerMove);\r\n      }\r\n    }, dt);\r\n    setTimerMove(timerMove);\r\n  };\r\n\r\n  const lazyMoveTail = (sx, sy, ex, ey, t = 200) => {\r\n    let dt = 16;\r\n    let nStep = t / dt;\r\n    if (nStep == 0) return;\r\n    let dx = (ex - sx) / nStep;\r\n    let dy = (ey - sy) / nStep;\r\n    let cnt = 0;\r\n\r\n    setTailX(sx);\r\n    setTailY(sy);\r\n    setIsTail(true);\r\n    setTimeout(() => setIsOverAvatar(true), 200);\r\n\r\n    let timerMoveTail = setInterval(() => {\r\n      if (cnt < nStep) {\r\n        setTailX((tailX) => tailX + dx);\r\n        setTailY((tailY) => tailY + dy);\r\n        cnt++;\r\n      } else {\r\n        setTailX(ex);\r\n        setTailY(ey);\r\n        setIsTail(false);\r\n        setTimeout(() => setIsOverAvatar(false), 100);\r\n\r\n        clearInterval(timerMoveTail);\r\n      }\r\n    }, dt);\r\n  };\r\n\r\n  let { xx, yy } = xyInRoom(x, y);\r\n  const user = getDicUser()[star.username];\r\n\r\n  const clickID = star.idSocket;\r\n\r\n  const onClickMsg = (e) => {\r\n    setIsEdit(!isEdit);\r\n  };\r\n\r\n  const ROOT_CSS = css({\r\n    height: isEdit ? \"140px\" : \"90px\",\r\n    overflowX: \"hidden\",\r\n  });\r\n\r\n  return (\r\n    <g transform={`translate(${xx},${yy})`}>\r\n      <image\r\n        className=\"scale-down-center\"\r\n        href={\r\n          isMe ? \"./assets/img/star1_thumb.png\" : \"./assets/img/star0_thumb.png\"\r\n        }\r\n        x=\"-15\"\r\n        y=\"-15\"\r\n        height={isOverAvatar ? \"40\" : \"30\"}\r\n        width={isOverAvatar ? \"40\" : \"30\"}\r\n        onMouseMove={(e) => {\r\n          setIsOverAvatar(true);\r\n        }}\r\n        onMouseLeave={(e) => {\r\n          setIsOverAvatar(false);\r\n        }}\r\n      />\r\n      <image\r\n        style={{ display: isTail ? \"block\" : \"none\" }}\r\n        href=\"./assets/img/star0_thumb.png\"\r\n        x={-xx + (parseInt(tailX) % ROOM_W) - 15}\r\n        y={-yy + (parseInt(tailY) % ROOM_W) - 15}\r\n        height=\"20\"\r\n        width=\"20\"\r\n      />\r\n      <foreignObject\r\n        id={clickID}\r\n        x=\"0\"\r\n        y=\"15\"\r\n        width=\"150\"\r\n        height=\"100\"\r\n        style={{ overflowY: \"auto\" }}\r\n      >\r\n        <div style={{ width: \"150px\", height: \"30px\" }}>\r\n          <Flag id={clickID} code={user.country} height=\"25px\" />\r\n          <strong style={{ marginLeft: \"10px\" }}>{user.username}</strong>\r\n        </div>\r\n      </foreignObject>\r\n\r\n      <rect\r\n        className=\"scale-down-center\"\r\n        x=\"0\"\r\n        y=\"40\"\r\n        rx=\"10\"\r\n        ry=\"10\"\r\n        width={isEdit ? \"350\" : \"150\"}\r\n        height={isEdit ? \"150\" : \"100\"}\r\n        style={{\r\n          fill: \"transparent\",\r\n          stroke: isMe ? \"yellow\" : \"white\",\r\n          strokeWidth: isMe ? 0.5 : 0.3,\r\n          opacity: isMe ? 1 : 0.5,\r\n        }}\r\n      />\r\n\r\n      <foreignObject\r\n        className=\"scale-down-center\"\r\n        x=\"0\"\r\n        y=\"40\"\r\n        width={isEdit ? \"350\" : \"150\"}\r\n        height={isEdit ? \"150\" : \"100\"}\r\n      >\r\n        <div\r\n          style={{ padding: \"5px\", position: \"relative\" }}\r\n          onMouseMove={(e) => {\r\n            setIsOverMsg(true);\r\n          }}\r\n          onMouseLeave={(e) => {\r\n            setIsOverMsg(false);\r\n          }}\r\n          onClick={onClickMsg}\r\n        >\r\n          {!isEdit && isOverMsg ? (\r\n            <i\r\n              className=\"fa fa-edit\"\r\n              style={{\r\n                fontSize: \"50px\",\r\n                position: \"absolute\",\r\n                top: 50,\r\n                left: 50,\r\n                opacity: 0.8,\r\n              }}\r\n            />\r\n          ) : null}\r\n\r\n          <ScrollToBottom className={ROOT_CSS}>\r\n            {star.arrMsg.map((message, i) => {\r\n              return (\r\n                <div key={i}>\r\n                  <span className=\"w3-text-teal\">\r\n                    {message.sender == Auth.username ? \"me\" : message.sender}:{\" \"}\r\n                  </span>\r\n                  <span className=\"ml-2\">{message.content}</span>\r\n                  <br />\r\n                </div>\r\n              );\r\n            })}\r\n          </ScrollToBottom>\r\n        </div>\r\n      </foreignObject>\r\n\r\n      {isEdit ? <InputContainer handleSubmit={handleMsgSubmit} /> : null}\r\n    </g>\r\n  );\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\nimport { Star } from \"./Star\";\r\nimport * as common from \"../modules/common\";\r\n\r\nconst ROOM_W = 2000; // width of room in real\r\n// export const nRoom = ni * ni;\r\n\r\nexport const Room = (props) => {\r\n  let { busy, room, me, arrMate, handleClickSVG, handleClickStar } = props;\r\n\r\n  useEffect(() => {\r\n    common.setMe(me);\r\n  }, [me]);\r\n\r\n  useEffect(() => {\r\n    common.setArrMate(arrMate);\r\n  }, [arrMate]);\r\n\r\n  const roomToDelta = (room) => {\r\n    let tmp = room.split(\"_\");\r\n    let x = parseInt(tmp[0]);\r\n    let y = parseInt(tmp[1]);\r\n    return { x, y };\r\n  };\r\n\r\n  const onClickSVG = (evt) => {\r\n    if (evt.target.id == \"svgRoom\") {\r\n      let target = document.getElementById(\"svgRoom\");\r\n      var dim = target.getBoundingClientRect();\r\n      var x = evt.clientX - dim.left;\r\n      var y = evt.clientY - dim.top;\r\n\r\n      let delta = roomToDelta(room);\r\n      x = parseInt(ROOM_W * delta.x + x);\r\n      y = parseInt(ROOM_W * delta.y + y);\r\n      handleClickSVG(x, y);\r\n    } else if (evt.target.id) {\r\n      let idSocket = evt.target.id;\r\n      handleClickStar(idSocket);\r\n    }\r\n  };\r\n\r\n  if (busy)\r\n    return (\r\n      <LoadingOverlay active={busy} spinner text=\"Loading...\"></LoadingOverlay>\r\n    );\r\n\r\n  return (\r\n    <div\r\n      id=\"star-container\"\r\n      style={{\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        overflow: \"auto\",\r\n      }}\r\n    >\r\n      <svg id=\"svgRoom\" width={ROOM_W} height={ROOM_W} onClick={onClickSVG}>\r\n        <Star star={me} isMe={true} me={props.me} />\r\n        {arrMate.map((mate, i) => (\r\n          <Star key={i} star={mate} isMe={false} me={props.me} />\r\n        ))}\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nconst MAP_W = 1000; // width of whole svg\r\nconst ni = 10; // number of cells in a row or a column\r\nconst wCell = 100; // width of room in map\r\nconst zoomRatio = 20; // zoom ratio between map and real\r\n\r\nexport const MapContainer = (props) => {\r\n  const { arrStar } = props;\r\n\r\n  const onClickSVG = (evt) => {\r\n    let target = document.getElementById(\"svgMap\");\r\n    var dim = target.getBoundingClientRect();\r\n    var x = evt.clientX - dim.left;\r\n    var y = evt.clientY - dim.top;\r\n    x = parseInt(x * zoomRatio);\r\n    y = parseInt(y * zoomRatio);\r\n    props.handleClick(x, y);\r\n  };\r\n\r\n  const roomBlocks = [];\r\n  for (let i = 0; i < ni; i++) {\r\n    for (let j = 0; j < ni; j++) {\r\n      roomBlocks.push(\r\n        <rect\r\n          key={`${i}-${j}`}\r\n          x={wCell * j}\r\n          y={wCell * i}\r\n          width={wCell}\r\n          height={wCell}\r\n          style={{ stroke: \"yellow\", strokeWidth: \"1px\" }}\r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div style={{ width: \"100%\", height: \"100%\", overflow: \"scroll\" }}>\r\n      <svg id=\"svgMap\" width={MAP_W} height={MAP_W} onClick={onClickSVG}>\r\n        {roomBlocks}\r\n        {arrStar.map((star, i) => (\r\n          <image\r\n            key={i}\r\n            href=\"./assets/img/star0_thumb.png\"\r\n            x={(star.x - 150) / zoomRatio}\r\n            y={(star.y - 150) / zoomRatio}\r\n            height=\"20\"\r\n            width=\"20\"\r\n          />\r\n        ))}\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\n","import React, { Component } from \"react\";\r\nimport countryList from \"react-select-country-list\";\r\nimport Flag from \"react-world-flags\";\r\n\r\nexport default class CountrySelectorSmall extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.arrCountry = countryList().getData();\r\n    this.arrCountry = [{ value: -1, label: \"All\" }, ...this.arrCountry];\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <select\r\n        className=\"input-transp-sm w3-black\"\r\n        style={{ width: \"100%\" }}\r\n        value={this.props.value}\r\n        onChange={(e) => this.props.onChange(e.target.value)}\r\n      >\r\n        {this.arrCountry.map((country, i) => (\r\n          <option key={i} value={country.value}>\r\n            {country.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    );\r\n  }\r\n}\r\n","import React, { useState } from \"react\";\r\nimport CountrySeletorSmall from \"../components/CountrySeletorSmall\";\r\n\r\nimport styled from \"styled-components\";\r\nconst Div = styled.div`\r\n  border: 1px dotted grey;\r\n`;\r\n\r\nexport const FilterBox = (props) => {\r\n  const { filter, handleChangeFilter } = props;\r\n\r\n  const [country, setCountry] = useState(filter.country);\r\n  const [gender, setGender] = useState(filter.gender);\r\n  const [age, setAge] = useState(filter.age);\r\n\r\n  const onClickFilter = (e) => {\r\n    let newFilter = { country, gender, age };\r\n    handleChangeFilter(newFilter);\r\n  };\r\n\r\n  return (\r\n    <div style={{ paddingTop: \"20px\" }}>\r\n      <div className=\"row\">\r\n        <span className=\"col-sm-4\">country</span>\r\n        <div className=\"col-sm-8\">\r\n          <CountrySeletorSmall onChange={(country) => setCountry(country)} />\r\n        </div>\r\n      </div>\r\n      <div className=\"row\">\r\n        <span className=\"col-sm-4\">age</span>\r\n        <div className=\"col-sm-8\">\r\n          <select\r\n            className=\"input-transp-sm w3-black\"\r\n            style={{ width: \"100%\" }}\r\n            onChange={(e) => setAge(Number(e.target.value))}\r\n          >\r\n            <option value={-1}>All</option>\r\n            <option value={10}>10~19</option>\r\n            <option value={20}>20~29</option>\r\n            <option value={30}>30~39</option>\r\n            <option value={40}>40~49</option>\r\n            <option value={50}>50~59</option>\r\n            <option value={60}>60~69</option>\r\n            <option value={70}>70~79</option>\r\n            <option value={80}>80~89</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div className=\"row\">\r\n        <span className=\"col-sm-4\">gender</span>\r\n        <div className=\"col-sm-8\">\r\n          <select\r\n            className=\"input-transp-sm w3-black\"\r\n            style={{ width: \"100%\" }}\r\n            onChange={(e) => setGender(Number(e.target.value))}\r\n          >\r\n            <option value={-1}>All</option>\r\n            <option value={0}>Male</option>\r\n            <option value={1}>Female</option>\r\n            <option value={2}>Other</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div className=\"row mt-2\">\r\n        <button\r\n          className=\"btn-transp-sm \"\r\n          style={{ width: \"100%\" }}\r\n          onClick={onClickFilter}\r\n        >\r\n          <i className=\"fa fa-filter\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\n\r\nimport * as Auth from \"../modules/Auth\";\r\nimport { getSocket, getDicUser, updateDicUser } from \"../modules/common\";\r\n\r\nimport * as HttpStar from \"../http/HttpStar\";\r\n\r\nimport { AuthButton } from \"../components/AuthButton\";\r\nimport { StarList } from \"../components/StarList\";\r\nimport { Room } from \"../components/Room\";\r\nimport { MapContainer } from \"../components/MapContainer\";\r\nimport { FilterBox } from \"../components/FilterBox\";\r\n\r\nimport styled from \"styled-components\";\r\nconst Div = styled.div`\r\n  border: 1px dotted grey;\r\n`;\r\nconst StrongHover = styled.strong`\r\n  &:hover {\r\n    cursor: pointer;\r\n  }\r\n`;\r\n\r\nexport const Main = () => {\r\n  let history = useHistory();\r\n\r\n  const [busy, setBusy] = useState(true);\r\n\r\n  const [arrStar, setArrStar] = useState([]);\r\n  const [filter, setFilter] = useState({ country: -1, age: -1, gender: -1 });\r\n\r\n  const [room, setRoom] = useState();\r\n  const [me, setMe] = useState();\r\n  const [arrMate, setArrMate] = useState([]);\r\n  const [isMap, setIsMap] = useState(false);\r\n\r\n  const initArrStar = async () => {\r\n    try {\r\n      let resp = await HttpStar.getMap();\r\n      let { arrStar } = resp.data;\r\n      await updateDicUser(arrStar);\r\n      setArrStar(arrStar);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let socket = getSocket();\r\n    doSetSocketHandlers(socket);\r\n    socket.emit(\"i-connected\", { username: Auth.username });\r\n    setBusy(true);\r\n\r\n    return () => {\r\n      let socket = getSocket();\r\n      socket.emit(\"i-disconnected\", { username: Auth.username });\r\n    };\r\n  }, []);\r\n\r\n  const doSetSocketHandlers = (socket) => {\r\n    socket.on(\"star-connected\", async ({ star }) => {\r\n      console.log(\"star-connected\");\r\n      if (star.username == Auth.username) {\r\n        initArrStar();\r\n      } else {\r\n        await updateDicUser([star]);\r\n        setArrStar((arrStar) => [...arrStar, star]);\r\n      }\r\n    });\r\n\r\n    socket.on(\"star-disconnected\", async ({ username }) => {\r\n      console.log(\"star-disconneted\", username);\r\n      setArrStar((arrStar) => {\r\n        let len = arrStar.length;\r\n        let k = arrStar.findIndex((star) => star.username == username);\r\n        if (k > -1) {\r\n          arrStar = [...arrStar.slice(0, k), ...arrStar.slice(k + 1, len)];\r\n        }\r\n        return arrStar;\r\n      });\r\n    });\r\n\r\n    socket.on(\"you-are-already-in\", async ({ username }) => {\r\n      window.alert(\"Your account is already in using. Sorry.\");\r\n      await Auth.doLogOut();\r\n      history.replace({ pathname: \"/login\" });\r\n    });\r\n\r\n    socket.on(\"you-joined-room\", async ({ room, me, arrMate }) => {\r\n      console.log(\"you-joined-room\");\r\n      await updateDicUser([...arrMate, me]);\r\n      setRoom(room);\r\n      setMe(me);\r\n      setArrMate(arrMate);\r\n      setBusy(false);\r\n    });\r\n\r\n    socket.on(\"mate-joined-room\", async ({ mate }) => {\r\n      console.log(\"mate-joined-room\");\r\n      await updateDicUser([mate]);\r\n      setArrMate((arrMate) => [...arrMate, mate]);\r\n    });\r\n\r\n    socket.on(\"mate-moved\", ({ username, x, y }) => {\r\n      setArrMate((arrMate) => {\r\n        let len = arrMate.length;\r\n        let k = arrMate.findIndex((mate) => mate.username == username);\r\n        if (k > -1) {\r\n          let mate = arrMate[k];\r\n          mate.x = x;\r\n          mate.y = y;\r\n          arrMate = [\r\n            ...arrMate.slice(0, k),\r\n            mate,\r\n            ...arrMate.slice(k + 1, len),\r\n          ];\r\n        }\r\n        return arrMate;\r\n      });\r\n    });\r\n\r\n    socket.on(\"mate-leaved-room\", ({ username }) => {\r\n      setArrMate((arrMate) => {\r\n        let len = arrMate.length;\r\n        let k = arrMate.findIndex((mate) => mate.username == username);\r\n        if (k > -1) {\r\n          arrMate = [...arrMate.slice(0, k), ...arrMate.slice(k + 1, len)];\r\n        }\r\n        return arrMate;\r\n      });\r\n    });\r\n\r\n    //chat handler\r\n\r\n    const MAX_MSG_LEN = 200;\r\n    const MAX_MSG_N = 10;\r\n\r\n    socket.on(\"chat-msg\", ({ sender, receiver, content }) => {\r\n      if (content.length > MAX_MSG_LEN)\r\n        content = content.substr(0, MAX_MSG_LEN);\r\n\r\n      if (receiver == Auth.username) {\r\n        setMe((me) => {\r\n          let newArrMsg = [...me.arrMsg, { sender, content }];\r\n          if (newArrMsg.length > MAX_MSG_N) newArrMsg.shift();\r\n          return { ...me, arrMsg: newArrMsg };\r\n        });\r\n      } else {\r\n        setArrMate((arrMate) => {\r\n          let k = arrMate.findIndex((mate) => mate.username == receiver);\r\n          if (k > -1) {\r\n            let mate = arrMate[k];\r\n            let newArrMsg = [...mate.arrMsg, { sender, content }];\r\n            if (newArrMsg.length > MAX_MSG_N) newArrMsg.shift();\r\n            let newMate = { ...mate, arrMsg: newArrMsg };\r\n\r\n            let len = arrMate.length;\r\n            return [\r\n              ...arrMate.slice(0, k),\r\n              newMate,\r\n              ...arrMate.slice(k + 1, len),\r\n            ];\r\n          } else {\r\n            return arrMate;\r\n          }\r\n        });\r\n      }\r\n    });\r\n  };\r\n\r\n  const moveMe = (x, y) => {\r\n    setMe((me) => ({ ...me, x, y }));\r\n    let socket = getSocket();\r\n    socket.emit(\"i-moved\", { username: Auth.username, x, y });\r\n  };\r\n\r\n  const moveToStar = async (star) => {\r\n    try {\r\n      let resp = await HttpStar.getXY(star.idSocket);\r\n      let { x, y } = resp.data;\r\n      if (\r\n        window.confirm(\r\n          `${star.username} is at (${x}, ${y}) now. Move to there?`\r\n        )\r\n      ) {\r\n        moveMe(x + 160, y);\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const onToggleMap = (e) => {\r\n    if (!isMap) initArrStar();\r\n    setIsMap(!isMap);\r\n  };\r\n\r\n  const handleClickMap = (x, y) => {\r\n    if (window.confirm(`Move to (${x}, ${y})?`)) {\r\n      setIsMap(false);\r\n      moveMe(x, y);\r\n    }\r\n  };\r\n\r\n  const handleClickSVG = (x, y) => {\r\n    moveMe(x, y);\r\n  };\r\n\r\n  const handleClickStar = (idSocket) => {\r\n    if (idSocket != me.idSocket) {\r\n      console.log(\"star clicked\");\r\n    }\r\n  };\r\n\r\n  const handleChangeFilter = (filter) => {\r\n    setFilter(filter);\r\n  };\r\n\r\n  const ROOM_W = 2000; // width of room in real\r\n  const elementParent = document.getElementById(\"star-container\");\r\n  const scrollToMe = () => {\r\n    if (elementParent)\r\n      elementParent.scrollTo({\r\n        left: (me.x % ROOM_W) - 170,\r\n        top: (me.y % ROOM_W) - 170,\r\n        behavior: \"smooth\",\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: \"20px\" }}>\r\n      <div className=\"row\">\r\n        <div className=\"col-12\" style={{ minHeight: \"40px\" }}>\r\n          <div className=\"text-center\">\r\n            <span style={{ fontSize: \"25px\" }}>Chatting Star</span>\r\n            <div className=\"w3-right\">\r\n              <AuthButton />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <Div className=\"col-sm-4 col-md-2\">\r\n          <div className=\"row\">\r\n            <div className=\"col-6 col-sm-12\">\r\n              <FilterBox\r\n                filter={filter}\r\n                handleChangeFilter={handleChangeFilter}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"col-6 col-sm-12\">\r\n              <StarList\r\n                filter={filter}\r\n                arrStar={arrStar}\r\n                moveToStar={moveToStar}\r\n              />\r\n            </div>\r\n          </div>\r\n        </Div>\r\n\r\n        <Div\r\n          className=\"col-sm-8 col-md-8\"\r\n          style={{ height: \"80vmin\", position: \"relative\", paddingTop: \"20px\" }}\r\n        >\r\n          {isMap ? (\r\n            <MapContainer arrStar={arrStar} handleClick={handleClickMap} />\r\n          ) : (\r\n            <Room\r\n              busy={busy}\r\n              room={room}\r\n              me={me}\r\n              arrMate={arrMate}\r\n              handleClickSVG={handleClickSVG}\r\n              handleClickStar={handleClickStar}\r\n            />\r\n          )}\r\n\r\n          <div style={{ position: \"absolute\", top: \"0px\", left: \"10px\" }}>\r\n            {me ? (\r\n              <StrongHover\r\n                className=\"w3-text-yellow ml-5\"\r\n                onClick={(e) => scrollToMe()}\r\n              >\r\n                ScrollToMe\r\n              </StrongHover>\r\n            ) : null}\r\n          </div>\r\n          <div style={{ position: \"absolute\", top: \"0px\", left: \"150px\" }}>\r\n            {room ? (\r\n              <StrongHover\r\n                className=\"w3-text-yellow mr-5\"\r\n                onClick={onToggleMap}\r\n              >\r\n                {isMap ? \"HideMap\" : \"ShowMap\"}\r\n              </StrongHover>\r\n            ) : null}\r\n          </div>\r\n        </Div>\r\n\r\n        <Div className=\"col-sm-12 col-md-2\" style={{ minHeight: \"100px\" }}>\r\n          Google Ads\r\n        </Div>\r\n        <Div className=\"col-12\" style={{ minHeight: \"100px\" }}>\r\n          Google Ads\r\n        </Div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\n\r\nimport * as Auth from \"../modules/Auth\";\r\n\r\nexport default class PrivateRoute extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isAuthed: false,\r\n      isLoading: true,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.check();\r\n  }\r\n\r\n  async check() {\r\n    this.setState({ isLoading: true });\r\n\r\n    let isAuthed = await Auth.checkAuth();\r\n    if (isAuthed) {\r\n      this.setState({\r\n        isAuthed: true,\r\n        isLoading: false,\r\n      });\r\n    } else {\r\n      this.setState({ isAuthed: false, isLoading: false });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.isLoading) return <div className=\"w3-black\">loading</div>;\r\n\r\n    return (\r\n      <Route\r\n        {...this.props.rest}\r\n        render={({ location }) =>\r\n          this.state.isAuthed ? (\r\n            this.props.children\r\n          ) : (\r\n            <Redirect to={{ pathname: \"/login\" }} />\r\n          )\r\n        }\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\n\nimport \"./styles/App.scss\";\nimport \"./styles/Anime.scss\";\nimport { LogIn } from \"./pages/LogIn\";\nimport { SignUp } from \"./pages/SignUp\";\nimport { Main } from \"./pages/Main\";\n\nimport PrivateRoute from \"./components/PrivateRoute.js\";\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/login\">\n          <LogIn />\n        </Route>\n\n        <Route path=\"/signup\">\n          <SignUp />\n        </Route>\n\n        <PrivateRoute path=\"/\">\n          <Main />\n        </PrivateRoute>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <App />,\r\n  // </React.StrictMode>\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}